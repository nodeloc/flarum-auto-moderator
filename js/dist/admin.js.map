{"version":3,"sources":["webpack://@nodeloc/flarum-auto-moderator/webpack/bootstrap","webpack://@nodeloc/flarum-auto-moderator/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nodeloc/flarum-auto-moderator/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['Model']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/utils/Stream']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['Component']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/Button']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nodeloc/flarum-auto-moderator/./src/common/utils/managedGroups.js","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/helpers/icon']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/Tooltip']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/utils/classList']\"","webpack://@nodeloc/flarum-auto-moderator/./src/common/components/ManagedGroups.js","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/Component']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/extend']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/EditUserModal']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/Alert']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/GroupBadge']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['models/User']\"","webpack://@nodeloc/flarum-auto-moderator/./src/common/models/Criterion.js","webpack://@nodeloc/flarum-auto-moderator/./src/common/registerModels.js","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/Select']\"","webpack://@nodeloc/flarum-auto-moderator/./src/common/augmentEditUserModal.js","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['components/Button']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/Switch']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['utils/Stream']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['models/Group']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['admin/components/ExtensionPage']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/Link']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/utils/stringToColor']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['admin/components/AdminPage']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['components/Dropdown']\"","webpack://@nodeloc/flarum-auto-moderator/external \"flarum.core.compat['helpers/icon']\"","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/AutoModeratorInstructions.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/AutoModeratorPage.js","webpack://@nodeloc/flarum-auto-moderator/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/UndefinedDriverItem.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/DriverSettings.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/ActionItem.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/MinMaxSelector.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/CriterionPage.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/MetricItem.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/RequirementItem.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/CriterionStatus.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/GroupSelector.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/GroupIdSelector.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/components/SuspendSelector.js","webpack://@nodeloc/flarum-auto-moderator/./src/admin/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_setPrototypeOf","e","setPrototypeOf","__proto__","_inheritsLoose","constructor","flarum","core","compat","managedGroups","criteria","ids","filter","criterion","actions","reduce","acc","a","type","map","settings","push","apply","Array","from","Set","values","groupId","app","store","getById","g","ManagedGroups","_Component","arguments","view","groups","this","attrs","user","className","translator","trans","group","checked","includes","disabled","badge","GroupBadge","component","label","groupName","nameSingular","Component","Criterion","_Model","Model","registerModels","models","User","hasMany","assign","attribute","icon","description","metrics","requirements","isValid","invalidActionSettings","invalidRequirementSettings","augmentEditUserModal","extend","EditUserModal","_this","loading","find","then","forEach","id","redraw","override","original","items","ItemList","add","LoadingIndicator","all","AutoModeratorInstructions","criterionItem","iconName","style","stringToColor","Link","href","route","classList","Tooltip","text","AutoModeratorPage","_ExtensionPage","_proto","oninit","vnode","content","concat","ExtensionPage","_extends","length","UndefinedDriverItem","item","selected","driverName","Button","onclick","val","DriverSettings","form","driverType","availableSettings","forms","autoModeratorForms","keys","onchange","newSettings","target","placeholder","ActionItem","action","actionDef","missingExt","translationKey","MinMaxSelector","state","min","max","Stream","controls","minInput","State","BETWEEN","Infinity","bidi","maxInput","Math","button","cycle","LTE","GTE","actionDefs","metricDefs","requirementDefs","MetricItem","metric","metricDef","RequirementItem","requirement","requirementDef","Switch","negated","CriterionStatus","messages","Alert","dismissible","actionValidation","join","requirementValidation","CriterionPage","_AdminPage","param","actionsOnGain","actionsOnLoss","newActionOnGain","newActionOnLoss","newMetric","newRequirement","loadingDrivers","request","method","url","forum","response","loadingCriterion","loadCriterion","gain","headerInfo","title","onsubmit","LinkButton","required","metricsAndRequirementsForm","actionsForm","saving","deleting","_this2","class","Select","options","_this3","data","preventDefault","set","_this4","createRecord","save","newCriterion","AdminPage","GroupSelector","namePlural","Dropdown","buttonClassName","Group","MEMBER_ID","GUEST_ID","active","GroupActionDriverSettings","group_id","SuspendSelector","indefinitely","days","initializers","routes","path","add_to_group","GroupIdSelector","remove_from_group","suspend","in_group","extensionData","registerPage"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 32);\n","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","export default function managedGroups(criteria) {\r\n  const ids = criteria\r\n    .filter((criterion) => {\r\n      return criterion.actions();\r\n    })\r\n    .reduce((acc, criterion) => {\r\n      const ids = criterion\r\n        .actions()\r\n        .filter(\r\n          (a) => a.type === \"add_to_group\" || a.type === \"remove_from_group\"\r\n        )\r\n        .map((a) => a.settings[\"group_id\"]);\r\n      acc.push(...ids);\r\n\r\n      return acc;\r\n    }, []);\r\n\r\n  return Array.from(new Set(ids).values())\r\n    .map((groupId) => app.store.getById(\"groups\", groupId))\r\n    .filter((g) => g);\r\n}\r\n","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/components/Tooltip'];","module.exports = flarum.core.compat['common/utils/classList'];","import Component from \"flarum/common/Component\";\r\nimport GroupBadge from \"flarum/common/components/GroupBadge\";\r\nimport managedGroups from \"../utils/managedGroups\";\r\n\r\nexport default class ManagedGroups extends Component {\r\n  view() {\r\n    const groups = managedGroups(this.attrs.criteria);\r\n    const user = this.attrs.user;\r\n\r\n    return (\r\n      <div className=\"ManagedGroups Form-group\">\r\n        <hr />\r\n        <h4>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.lib.managed_groups.header\"\r\n          )}\r\n        </h4>\r\n        <ul>\r\n          {groups.map((group) => (\r\n            <label className=\"checkbox\">\r\n              {user && (\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={user.groups().includes(group)}\r\n                  disabled={true}\r\n                />\r\n              )}\r\n              {app.translator.trans(\r\n                \"nodeloc-auto-moderator.lib.managed_groups.group_item\",\r\n                {\r\n                  badge: GroupBadge.component({\r\n                    group,\r\n                    label: \"\",\r\n                  }),\r\n                  groupName: group.nameSingular(),\r\n                }\r\n              )}\r\n            </label>\r\n          ))}\r\n        </ul>\r\n        <p>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.lib.managed_groups.groups_not_editable\"\r\n          )}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/components/EditUserModal'];","module.exports = flarum.core.compat['common/components/Alert'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/components/GroupBadge'];","module.exports = flarum.core.compat['models/User'];","import Model from \"flarum/Model\";\r\n\r\nexport default class Criterion extends Model {}\r\n\r\nObject.assign(Criterion.prototype, {\r\n  name: Model.attribute(\"name\"),\r\n  icon: Model.attribute(\"icon\"),\r\n  description: Model.attribute(\"description\"),\r\n  actions: Model.attribute(\"actions\"),\r\n  metrics: Model.attribute(\"metrics\"),\r\n  requirements: Model.attribute(\"requirements\"),\r\n  isValid: Model.attribute(\"isValid\"),\r\n  invalidActionSettings: Model.attribute(\"invalidActionSettings\"),\r\n  invalidRequirementSettings: Model.attribute(\"invalidRequirementSettings\"),\r\n});\r\n","import Model from \"flarum/Model\";\r\nimport User from \"flarum/models/User\";\r\nimport Criterion from \"./models/Criterion\";\r\n\r\nexport default function registerModels() {\r\n  app.store.models.criteria = Criterion;\r\n\r\n  User.prototype.criteria = Model.hasMany(\"criteria\");\r\n}\r\n","module.exports = flarum.core.compat['common/components/Select'];","import { extend, override } from \"flarum/common/extend\";\r\nimport EditUserModal from \"flarum/common/components/EditUserModal\";\r\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\r\nimport ItemList from \"flarum/common/utils/ItemList\";\r\nimport managedGroups from \"./utils/managedGroups\";\r\nimport ManagedGroups from \"./components/ManagedGroups\";\r\n\r\nexport default function augmentEditUserModal() {\r\n  extend(EditUserModal.prototype, \"oninit\", function () {\r\n    this.loading = true;\r\n    app.store.find(\"criteria\").then((criteria) => {\r\n      managedGroups(criteria).forEach(\r\n        (group) => delete this.groups[group.id()]\r\n      );\r\n\r\n      this.loading = false;\r\n      m.redraw();\r\n    });\r\n  });\r\n\r\n  override(EditUserModal.prototype, \"fields\", function (original) {\r\n    if (this.loading) {\r\n      const items = new ItemList();\r\n      items.add(\"loading\", <LoadingIndicator></LoadingIndicator>);\r\n      return items;\r\n    }\r\n\r\n    const items = original();\r\n\r\n    items.add(\r\n      \"Criteria\",\r\n      <ManagedGroups\r\n        criteria={app.store.all(\"criteria\")}\r\n        user={this.attrs.user}\r\n      />,\r\n      10\r\n    );\r\n\r\n    return items;\r\n  });\r\n}\r\n","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['common/components/Switch'];","module.exports = flarum.core.compat['utils/Stream'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['admin/components/ExtensionPage'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/utils/stringToColor'];","module.exports = flarum.core.compat['admin/components/AdminPage'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['helpers/icon'];","import Component from \"flarum/Component\";\r\n\r\nexport default class AutoModeratorInstructions extends Component {\r\n  view() {\r\n    return (\r\n      <div className=\"AutoModeratorInstructions\">\r\n        <h4>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.automoderator_instructions.header\"\r\n          )}\r\n        </h4>\r\n        <ul>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.automoderator_instructions.text\"\r\n          )}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import ExtensionPage from \"flarum/admin/components/ExtensionPage\";\r\nimport Link from \"flarum/common/components/Link\";\r\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\r\nimport Tooltip from \"flarum/common/components/Tooltip\";\r\nimport icon from \"flarum/common/helpers/icon\";\r\nimport classList from \"flarum/common/utils/classList\";\r\nimport stringToColor from \"flarum/common/utils/stringToColor\";\r\nimport ManagedGroups from \"../../common/components/ManagedGroups\";\r\nimport AutoModeratorInstructions from \"./AutoModeratorInstructions\";\r\n\r\nfunction criterionItem(criterion) {\r\n  const name = criterion\r\n    ? criterion.name()\r\n    : app.translator.trans(\r\n        \"nodeloc-auto-moderator.admin.automoderator_page.create_criterion_button\"\r\n      );\r\n  const iconName = criterion\r\n    ? criterion.icon() || \"fas fa-bolt\"\r\n    : \"fas fa-plus\";\r\n  const style = criterion\r\n    ? { \"background-color\": `#${stringToColor(criterion.name())}` }\r\n    : \"\";\r\n\r\n  return (\r\n    <Link className=\"ExtensionListItem\" href={app.route.criterion(criterion)}>\r\n      <span className=\"ExtensionListItem-icon ExtensionIcon\" style={style}>\r\n        {icon(iconName)}\r\n      </span>\r\n      <span\r\n        className={classList({\r\n          \"ExtensionListItem-title\": true,\r\n          \"ExtensionListItem--invalid\": criterion && !criterion.isValid(),\r\n        })}\r\n      >\r\n        {criterion && !criterion.isValid() && (\r\n          <Tooltip\r\n            text={app.translator.trans(\r\n              \"nodeloc-auto-moderator.admin.automoderator_page.criterion_invalid\"\r\n            )}\r\n          >\r\n            {icon(\"fas fa-exclamation-triangle\")}\r\n          </Tooltip>\r\n        )}\r\n        {name}\r\n      </span>\r\n    </Link>\r\n  );\r\n}\r\n\r\nexport default class AutoModeratorPage extends ExtensionPage {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.loading = true;\r\n\r\n    app.store.find(\"criteria\").then(() => {\r\n      this.loading = false;\r\n      m.redraw();\r\n    });\r\n  }\r\n  content() {\r\n    if (this.loading) {\r\n      return (\r\n        <div className=\"Criteria\">\r\n          <div className=\"container\">\r\n            <LoadingIndicator />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"Criteria\">\r\n        <div className=\"container\">\r\n          <div className=\"ExtensionsWidget-list Criteria-list\">\r\n            <p className=\"Criteria-list-heading\">\r\n              {app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.automoderator_page.list_heading\"\r\n              )}\r\n            </p>\r\n            <div className=\"ExtensionList\">\r\n              {[\r\n                ...app.store.all(\"criteria\").map(criterionItem),\r\n                criterionItem(),\r\n              ]}\r\n            </div>\r\n          </div>\r\n          <ManagedGroups criteria={app.store.all(\"criteria\")} />\r\n          <hr />\r\n          <AutoModeratorInstructions />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","import Component from \"flarum/Component\";\r\nimport Button from \"flarum/common/components/Button\";\r\n\r\nexport default class UndefinedDriverItem extends Component {\r\n  view() {\r\n    const item = this.attrs.item;\r\n    const selected = this.attrs.selected;\r\n\r\n    return (\r\n      <li>\r\n        <div className=\"DriverListItem-info\">\r\n          <span className=\"DriverListItem-name DriverListItem-undefined\">\r\n            {app.translator.trans(\r\n              \"nodeloc-auto-moderator.admin.undefined_driver_item.text\",\r\n              { driverName: item.type }\r\n            )}\r\n          </span>\r\n          {Button.component({\r\n            className: \"Button Button--link\",\r\n            icon: \"fas fa-trash-alt\",\r\n            onclick: () => selected(selected().filter((val) => val !== item)),\r\n          })}\r\n        </div>\r\n        <hr />\r\n      </li>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\n\r\nexport default class DriverSettings extends Component {\r\n  view() {\r\n    const driverType = this.attrs.driverType;\r\n    const type = this.attrs.type;\r\n    const settings = this.attrs.settings;\r\n    const availableSettings = this.attrs.availableSettings;\r\n\r\n    const forms = app.autoModeratorForms[driverType];\r\n\r\n    let form;\r\n    if (type in forms) {\r\n      form = forms[type].component({ settings, availableSettings });\r\n    } else {\r\n      form = Object.keys(availableSettings).map((s) => (\r\n        <div className=\"Form-group\">\r\n          <input\r\n            className=\"FormControl\"\r\n            value={settings()[s]}\r\n            onchange={(e) => {\r\n              const newSettings = { ...settings() };\r\n              newSettings[s] = e.target.value;\r\n              settings(newSettings);\r\n            }}\r\n            placeholder={app.translator.trans(availableSettings[s])}\r\n          />\r\n        </div>\r\n      ));\r\n    }\r\n\r\n    return <div className=\"DriverListItem-form\">{form}</div>;\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport Tooltip from \"flarum/common/components/Tooltip\";\r\nimport icon from \"flarum/common/helpers/icon\";\r\nimport classList from \"flarum/common/utils/classList\";\r\n\r\nimport UndefinedDriverItem from \"./UndefinedDriverItem\";\r\nimport DriverSettings from \"./DriverSettings\";\r\n\r\nexport default class ActionItem extends Component {\r\n  view() {\r\n    const action = this.attrs.action;\r\n    const actionDef = this.attrs.actionDef;\r\n    const selected = this.attrs.selected;\r\n\r\n    if (!actionDef)\r\n      return <UndefinedDriverItem item={action} selected={selected} />;\r\n\r\n    return (\r\n      <li>\r\n        <div\r\n          className={classList({\r\n            \"DriverListItem-info\": true,\r\n            \"DriverListItem--missingExt\": actionDef.missingExt,\r\n          })}\r\n        >\r\n          {actionDef.missingExt && (\r\n            <Tooltip\r\n              text={app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.driver_missing_ext\"\r\n              )}\r\n            >\r\n              {icon(\"fas fa-exclamation-triangle\")}\r\n            </Tooltip>\r\n          )}\r\n          <span className=\"DriverListItem-name\">\r\n            {app.translator.trans(actionDef.translationKey)}\r\n          </span>\r\n          {Button.component({\r\n            className: \"Button Button--link\",\r\n            icon: \"fas fa-trash-alt\",\r\n            onclick: () => selected(selected().filter((val) => val !== action)),\r\n          })}\r\n          <DriverSettings\r\n            driverType=\"action\"\r\n            type={action.type}\r\n            settings={action.settings}\r\n            availableSettings={actionDef.availableSettings}\r\n          />\r\n        </div>\r\n        <hr />\r\n      </li>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport Button from \"flarum/components/Button\";\r\nimport Stream from \"flarum/utils/Stream\";\r\n\r\nclass MinMaxSelector extends Component {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.state = -1;\r\n    if (this.attrs.min() !== -1) this.state += 1;\r\n    if (this.attrs.max() !== -1) this.state += 2;\r\n\r\n    this.min = Stream(this.attrs.min());\r\n    this.max = Stream(this.attrs.max());\r\n  }\r\n\r\n  view() {\r\n    return (\r\n      <div className=\"Form-group MinMaxSelector\">\r\n        <label>{this.attrs.label}</label>\r\n        <div className=\"MinMaxSelector--inputs\">{this.controls()}</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  controls() {\r\n    const minInput = () => (\r\n      <input\r\n        className=\"FormControl\"\r\n        type=\"number\"\r\n        min=\"0\"\r\n        max={\r\n          this.state === MinMaxSelector.State.BETWEEN\r\n            ? this.attrs.max() !== -1\r\n              ? this.attrs.max()\r\n              : this.max()\r\n            : Infinity\r\n        }\r\n        placeholder=\"min\"\r\n        bidi={this.attrs.min}\r\n      ></input>\r\n    );\r\n\r\n    const maxInput = () => (\r\n      <input\r\n        className=\"FormControl\"\r\n        type=\"number\"\r\n        min={\r\n          this.state ===\r\n          Math.max(\r\n            0,\r\n            MinMaxSelector.State.BETWEEN\r\n              ? this.attrs.min() !== -1\r\n                ? this.attrs.min()\r\n                : this.min()\r\n              : 0\r\n          )\r\n        }\r\n        placeholder=\"max\"\r\n        bidi={this.attrs.max}\r\n      ></input>\r\n    );\r\n\r\n    const placeholder = () => (\r\n      <input\r\n        className=\"FormControl MinMaxSelector--placeholder\"\r\n        disabled\r\n        placeholder=\"X\"\r\n      ></input>\r\n    );\r\n\r\n    const button = (icon) => (\r\n      <Button\r\n        className=\"Button\"\r\n        onclick={this.cycle.bind(this)}\r\n        icon={icon}\r\n      ></Button>\r\n    );\r\n\r\n    switch (this.state) {\r\n      case MinMaxSelector.State.LTE:\r\n        return [placeholder(), button(\"fas fa-less-than-equal\"), maxInput()];\r\n      case MinMaxSelector.State.GTE:\r\n        return [placeholder(), button(\"fas fa-greater-than-equal\"), minInput()];\r\n      case MinMaxSelector.State.BETWEEN:\r\n        return [\r\n          minInput(),\r\n          button(\"fas fa-less-than-equal\"),\r\n          placeholder(),\r\n          button(\"fas fa-less-than-equal\"),\r\n          maxInput(),\r\n        ];\r\n    }\r\n  }\r\n\r\n  cycle() {\r\n    this.state++;\r\n    this.state %= 3;\r\n\r\n    if (this.attrs.min() !== -1) this.min(this.attrs.min());\r\n    if (this.attrs.max() !== -1) this.max(this.attrs.max());\r\n\r\n    switch (this.state) {\r\n      case MinMaxSelector.State.GTE:\r\n        this.attrs.min(this.min());\r\n        this.attrs.max(-1);\r\n        break;\r\n      case MinMaxSelector.State.LTE:\r\n        this.attrs.min(-1);\r\n        this.attrs.max(this.max());\r\n        break;\r\n      case MinMaxSelector.State.BETWEEN:\r\n        this.attrs.min(this.min());\r\n        this.attrs.max(this.max());\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nMinMaxSelector.State = {\r\n  GTE: 0,\r\n  LTE: 1,\r\n  BETWEEN: 2,\r\n};\r\n\r\nexport default MinMaxSelector;\r\n","import AdminPage from \"flarum/admin/components/AdminPage\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport LinkButton from \"flarum/common/components/LinkButton\";\r\nimport Select from \"flarum/common/components/Select\";\r\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\r\nimport Stream from \"flarum/common/utils/Stream\";\r\nimport ActionItem from \"./ActionItem\";\r\nimport MetricItem from \"./MetricItem\";\r\nimport RequirementItem from \"./RequirementItem\";\r\nimport CriterionStatus from \"./CriterionStatus\";\r\nimport AutoModeratorInstructions from \"./AutoModeratorInstructions\";\r\n\r\nlet actionDefs;\r\nlet metricDefs;\r\nlet requirementDefs;\r\n\r\nexport default class CriterionPage extends AdminPage {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.id = m.route.param(\"id\");\r\n\r\n    this.name = Stream(\"\");\r\n    this.icon = Stream(\"fas fa-bolt\");\r\n    this.description = Stream(\"\");\r\n    this.actionsOnGain = Stream([]);\r\n    this.actionsOnLoss = Stream([]);\r\n    this.metrics = Stream([]);\r\n    this.requirements = Stream([]);\r\n\r\n    this.newActionOnGain = Stream(\"\");\r\n    this.newActionOnLoss = Stream(\"\");\r\n    this.newMetric = Stream(\"\");\r\n    this.newRequirement = Stream(\"\");\r\n\r\n    this.loadingDrivers = true;\r\n\r\n    app\r\n      .request({\r\n        method: \"GET\",\r\n        url: app.forum.attribute(\"apiUrl\") + \"/automod_drivers\",\r\n      })\r\n      .then((response) => {\r\n        actionDefs = response[\"data\"][\"attributes\"][\"action\"];\r\n        metricDefs = response[\"data\"][\"attributes\"][\"metric\"];\r\n        requirementDefs = response[\"data\"][\"attributes\"][\"requirement\"];\r\n\r\n        this.loadingDrivers = false;\r\n        m.redraw();\r\n      });\r\n\r\n    if (this.id === \"new\") return;\r\n\r\n    this.loadingCriterion = true;\r\n\r\n    app.store.find(\"criteria\", this.id).then((criterion) => {\r\n      this.loadCriterion(criterion);\r\n      this.loadingCriterion = false;\r\n      m.redraw();\r\n    });\r\n  }\r\n\r\n  loadCriterion(criterion) {\r\n    this.criterion = criterion;\r\n    this.name(criterion.name());\r\n    this.icon(criterion.icon() || \"fas fa-bolt\");\r\n    this.description(criterion.description());\r\n    this.metrics(\r\n      criterion.metrics().map((m) => {\r\n        return { type: m.type, min: Stream(m.min), max: Stream(m.max) };\r\n      })\r\n    );\r\n    this.actionsOnGain(\r\n      criterion\r\n        .actions()\r\n        .filter((a) => a.gain)\r\n        .map((a) => {\r\n          return { type: a.type, settings: Stream(a.settings) };\r\n        })\r\n    );\r\n    this.actionsOnLoss(\r\n      criterion\r\n        .actions()\r\n        .filter((a) => !a.gain)\r\n        .map((a) => {\r\n          return { type: a.type, settings: Stream(a.settings) };\r\n        })\r\n    );\r\n    this.requirements(\r\n      criterion.requirements().map((r) => {\r\n        return {\r\n          type: r.type,\r\n          negated: Stream(r.negated),\r\n          settings: Stream(r.settings),\r\n        };\r\n      })\r\n    );\r\n  }\r\n\r\n  headerInfo() {\r\n    let title;\r\n    let description = \"\";\r\n\r\n    if (this.loadingCriterion) {\r\n      description = app.translator.trans(\r\n        \"nodeloc-auto-moderator.admin.criterion_page.loading\"\r\n      );\r\n      title = app.translator.trans(\r\n        \"nodeloc-auto-moderator.admin.criterion_page.loading\"\r\n      );\r\n    } else if (this.criterion) {\r\n      title = this.criterion.name();\r\n    } else {\r\n      title = app.translator.trans(\r\n        \"nodeloc-auto-moderator.admin.criterion_page.new_criterion\"\r\n      );\r\n    }\r\n\r\n    return {\r\n      className: \"CriterionPage\",\r\n      icon: this.icon(),\r\n      title,\r\n      description,\r\n    };\r\n  }\r\n\r\n  content() {\r\n    if (this.loadingCriterion || this.loadingDrivers) {\r\n      return (\r\n        <div className=\"Criteria\">\r\n          <div className=\"container\">\r\n            <LoadingIndicator />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"Criteria\">\r\n        <div className=\"container\">\r\n          <form onsubmit={this.onsubmit.bind(this)}>\r\n            <div className=\"Form-group\">\r\n              <LinkButton\r\n                className=\"Button\"\r\n                icon=\"fas fa-chevron-left\"\r\n                href={app.route(\"extension\", {\r\n                  id: \"nodeloc-auto-moderator\",\r\n                })}\r\n              >\r\n                {app.translator.trans(\r\n                  \"nodeloc-auto-moderator.admin.criterion_page.back\"\r\n                )}\r\n              </LinkButton>\r\n            </div>\r\n            <CriterionStatus criterion={this.criterion} />\r\n            <div className=\"Form-group\">\r\n              <label>\r\n                {app.translator.trans(\r\n                  \"nodeloc-auto-moderator.admin.criterion_page.name_label\"\r\n                )}\r\n              </label>\r\n              <input className=\"FormControl\" bidi={this.name} required={true} />\r\n            </div>\r\n            <div className=\"Form-group\">\r\n              <label>\r\n                {app.translator.trans(\r\n                  \"nodeloc-auto-moderator.admin.criterion_page.icon_label\"\r\n                )}\r\n              </label>\r\n              <input className=\"FormControl\" bidi={this.icon} required={true} />\r\n            </div>\r\n            <div className=\"Form-group\">\r\n              <label>\r\n                {app.translator.trans(\r\n                  \"nodeloc-auto-moderator.admin.criterion_page.description_label\"\r\n                )}\r\n              </label>\r\n              <input className=\"FormControl\" bidi={this.description} />\r\n            </div>\r\n            {this.metricsAndRequirementsForm()}\r\n            {this.actionsForm()}\r\n            <div className=\"Form-group\">\r\n              <Button\r\n                type=\"submit\"\r\n                className=\"Button Button--primary\"\r\n                loading={this.saving}\r\n                disabled={this.saving}\r\n              >\r\n                {app.translator.trans(\"core.admin.settings.submit_button\")}\r\n              </Button>\r\n            </div>\r\n            {this.criterion && (\r\n              <Button\r\n                type=\"button\"\r\n                onclick={this.delete.bind(this)}\r\n                className=\"Button Button--danger\"\r\n                loading={this.deleting}\r\n                disabled={this.saving}\r\n              >\r\n                {app.translator.trans(\r\n                  \"nodeloc-auto-moderator.admin.criterion_page.delete_button\"\r\n                )}\r\n              </Button>\r\n            )}\r\n          </form>\r\n          <hr />\r\n          <AutoModeratorInstructions />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  metricsAndRequirementsForm() {\r\n    return (\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_page.metrics_and_requirements_label\"\r\n          )}\r\n        </label>\r\n        <div className=\"helpText\">\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_page.metrics_and_requirements_help\"\r\n          )}\r\n        </div>\r\n        <div className=\"SettingsGroups\">\r\n          <div className=\"DriverGroup\">\r\n            <label>\r\n              {app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.metrics_heading\"\r\n              )}\r\n            </label>\r\n            <ul className=\"DriverList DriverList--primary\">\r\n              {this.metrics().map((metric) => (\r\n                <MetricItem\r\n                  metric={metric}\r\n                  metricDef={metricDefs[metric.type]}\r\n                  selected={this.metrics}\r\n                />\r\n              ))}\r\n            </ul>\r\n            <span class=\"DriverGroup-controls\">\r\n              {Select.component({\r\n                options: Object.keys(metricDefs).reduce((acc, key) => {\r\n                  acc[key] = app.translator.trans(\r\n                    metricDefs[key].translationKey\r\n                  );\r\n                  return acc;\r\n                }, {}),\r\n                value: this.newMetric(),\r\n                onchange: this.newMetric,\r\n              })}\r\n              {Button.component({\r\n                className: \"Button DriverList-button\",\r\n                icon: \"fas fa-plus\",\r\n                disabled: !this.newMetric(),\r\n                onclick: () => {\r\n                  this.metrics([\r\n                    ...this.metrics(),\r\n                    { type: this.newMetric(), min: Stream(), max: Stream() },\r\n                  ]);\r\n                },\r\n              })}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"DriverGroup DriverGroup--secondary\">\r\n            <label>\r\n              {app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.requirements_heading\"\r\n              )}\r\n            </label>\r\n            <ul className=\"DriverList DriverList--primary\">\r\n              {this.requirements().map((r) => (\r\n                <RequirementItem\r\n                  requirement={r}\r\n                  requirementDef={requirementDefs[r.type]}\r\n                  selected={this.requirements}\r\n                />\r\n              ))}\r\n            </ul>\r\n            <span class=\"DriverGroup-controls\">\r\n              {Select.component({\r\n                options: Object.keys(requirementDefs).reduce((acc, key) => {\r\n                  acc[key] = app.translator.trans(\r\n                    requirementDefs[key].translationKey\r\n                  );\r\n                  return acc;\r\n                }, {}),\r\n                value: this.newRequirement(),\r\n                onchange: this.newRequirement,\r\n              })}\r\n              {Button.component({\r\n                className: \"Button DriverList-button\",\r\n                icon: \"fas fa-plus\",\r\n                disabled: !this.newRequirement(),\r\n                onclick: () => {\r\n                  this.requirements([\r\n                    ...this.requirements(),\r\n                    {\r\n                      type: this.newRequirement(),\r\n                      negated: Stream(false),\r\n                      settings: Stream({}),\r\n                    },\r\n                  ]);\r\n                },\r\n              })}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  actionsForm() {\r\n    return (\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_page.actions_label\"\r\n          )}\r\n        </label>\r\n        <div className=\"helpText\">\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_page.actions_help\"\r\n          )}\r\n        </div>\r\n        <div className=\"SettingsGroups\">\r\n          <div className=\"DriverGroup\">\r\n            <label>\r\n              {app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.actions_on_gain_heading\"\r\n              )}\r\n            </label>\r\n            <ul className=\"DriverList DriverList--primary\">\r\n              {this.actionsOnGain().map((a) => (\r\n                <ActionItem\r\n                  action={a}\r\n                  actionDef={actionDefs[a.type]}\r\n                  selected={this.actionsOnGain}\r\n                />\r\n              ))}\r\n            </ul>\r\n            <span class=\"DriverGroup-controls\">\r\n              {Select.component({\r\n                options: Object.keys(actionDefs).reduce((acc, key) => {\r\n                  acc[key] = app.translator.trans(\r\n                    actionDefs[key].translationKey\r\n                  );\r\n                  return acc;\r\n                }, {}),\r\n                value: this.newActionOnGain(),\r\n                onchange: this.newActionOnGain,\r\n              })}\r\n              {Button.component({\r\n                className: \"Button DriverList-button\",\r\n                icon: \"fas fa-plus\",\r\n                disabled: !this.newActionOnGain(),\r\n                onclick: () => {\r\n                  this.actionsOnGain([\r\n                    ...this.actionsOnGain(),\r\n                    { type: this.newActionOnGain(), settings: Stream({}) },\r\n                  ]);\r\n                },\r\n              })}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"DriverGroup DriverGroup--secondary\">\r\n            <label>\r\n              {app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.actions_on_loss_heading\"\r\n              )}\r\n            </label>\r\n            <ul className=\"DriverList\">\r\n              {this.actionsOnLoss().map((a) => (\r\n                <ActionItem\r\n                  action={a}\r\n                  actionDef={actionDefs[a.type]}\r\n                  selected={this.actionsOnLoss}\r\n                />\r\n              ))}\r\n            </ul>\r\n            <span class=\"DriverGroup-controls\">\r\n              {Select.component({\r\n                options: Object.keys(actionDefs).reduce((acc, key) => {\r\n                  acc[key] = app.translator.trans(\r\n                    actionDefs[key].translationKey\r\n                  );\r\n                  return acc;\r\n                }, {}),\r\n                value: this.newActionOnLoss(),\r\n                onchange: this.newActionOnLoss,\r\n              })}\r\n              {Button.component({\r\n                className: \"Button DriverList-button\",\r\n                icon: \"fas fa-plus\",\r\n                disabled: !this.newActionOnLoss(),\r\n                onclick: () => {\r\n                  this.actionsOnLoss([\r\n                    ...this.actionsOnLoss(),\r\n                    { type: this.newActionOnLoss(), settings: Stream({}) },\r\n                  ]);\r\n                },\r\n              })}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  data() {\r\n    return {\r\n      name: this.name(),\r\n      icon: this.icon(),\r\n      description: this.description(),\r\n      actions: [\r\n        ...this.actionsOnGain().map((a) => {\r\n          return { ...a, gain: true, settings: a.settings() };\r\n        }),\r\n        ...this.actionsOnLoss().map((a) => {\r\n          return { ...a, gain: false, settings: a.settings() };\r\n        }),\r\n      ],\r\n      metrics: this.metrics().map((m) => {\r\n        return { type: m.type, min: m.min(), max: m.max() };\r\n      }),\r\n      requirements: this.requirements().map((r) => {\r\n        return { type: r.type, negated: r.negated(), settings: r.settings() };\r\n      }),\r\n    };\r\n  }\r\n\r\n  delete(e) {\r\n    e.preventDefault();\r\n\r\n    this.deleting = true;\r\n    m.redraw();\r\n\r\n    this.criterion.delete().then(() => {\r\n      m.route.set(app.route(\"extension\", { id: \"nodeloc-auto-moderator\" }));\r\n    });\r\n  }\r\n\r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    this.saving = true;\r\n    m.redraw();\r\n\r\n    const criterion = this.criterion || app.store.createRecord(\"criteria\");\r\n\r\n    criterion.save(this.data()).then((newCriterion) => {\r\n      if (this.id === \"new\") {\r\n        m.route.set(app.route.criterion(newCriterion));\r\n      } else {\r\n        this.loadCriterion(criterion);\r\n        this.saving = false;\r\n        m.redraw();\r\n      }\r\n    });\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport Tooltip from \"flarum/common/components/Tooltip\";\r\nimport icon from \"flarum/common/helpers/icon\";\r\nimport classList from \"flarum/common/utils/classList\";\r\nimport MinMaxSelector from \"./MinMaxSelector\";\r\n\r\nimport UndefinedDriverItem from \"./UndefinedDriverItem\";\r\n\r\nexport default class MetricItem extends Component {\r\n  view() {\r\n    const metric = this.attrs.metric;\r\n    const metricDef = this.attrs.metricDef;\r\n    const selected = this.attrs.selected;\r\n\r\n    if (!metricDef)\r\n      return <UndefinedDriverItem item={metric} selected={selected} />;\r\n\r\n    return (\r\n      <li>\r\n        <div\r\n          className={classList({\r\n            \"DriverListItem-info\": true,\r\n            \"DriverListItem--missingExt\": metricDef.missingExt,\r\n          })}\r\n        >\r\n          {metricDef.missingExt && (\r\n            <Tooltip\r\n              text={app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.driver_missing_ext\"\r\n              )}\r\n            >\r\n              {icon(\"fas fa-exclamation-triangle\")}\r\n            </Tooltip>\r\n          )}\r\n          <span className=\"DriverListItem-name\">\r\n            {app.translator.trans(metricDef.translationKey)}\r\n          </span>\r\n          {Button.component({\r\n            className: \"Button Button--link\",\r\n            icon: \"fas fa-trash-alt\",\r\n            onclick: () => selected(selected().filter((val) => val !== metric)),\r\n          })}\r\n        </div>\r\n        <MinMaxSelector min={metric.min} max={metric.max}></MinMaxSelector>\r\n        <hr />\r\n      </li>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport Button from \"flarum/common/components/Button\";\r\nimport Switch from \"flarum/common/components/Switch\";\r\nimport Tooltip from \"flarum/common/components/Tooltip\";\r\nimport icon from \"flarum/common/helpers/icon\";\r\nimport classList from \"flarum/common/utils/classList\";\r\n\r\nimport UndefinedDriverItem from \"./UndefinedDriverItem\";\r\nimport DriverSettings from \"./DriverSettings\";\r\n\r\nexport default class RequirementItem extends Component {\r\n  view() {\r\n    const requirement = this.attrs.requirement;\r\n    const requirementDef = this.attrs.requirementDef;\r\n    const selected = this.attrs.selected;\r\n\r\n    if (!requirementDef)\r\n      return <UndefinedDriverItem item={requirement} selected={selected} />;\r\n\r\n    return (\r\n      <li>\r\n        <div\r\n          className={classList({\r\n            \"DriverListItem-info\": true,\r\n            \"DriverListItem--missingExt\": requirementDef.missingExt,\r\n          })}\r\n        >\r\n          {requirementDef.missingExt && (\r\n            <Tooltip\r\n              text={app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.criterion_page.driver_missing_ext\"\r\n              )}\r\n            >\r\n              {icon(\"fas fa-exclamation-triangle\")}\r\n            </Tooltip>\r\n          )}\r\n          <span className=\"DriverListItem-name\">\r\n            {app.translator.trans(requirementDef.translationKey)}\r\n          </span>\r\n          {Button.component({\r\n            className: \"Button Button--link\",\r\n            icon: \"fas fa-trash-alt\",\r\n            onclick: () =>\r\n              selected(selected().filter((val) => val !== requirement)),\r\n          })}\r\n        </div>\r\n        <Switch state={requirement.negated()} onchange={requirement.negated}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_page.negated\"\r\n          )}\r\n        </Switch>\r\n        <DriverSettings\r\n          driverType=\"requirement\"\r\n          type={requirement.type}\r\n          settings={requirement.settings}\r\n          availableSettings={requirementDef.availableSettings}\r\n        />\r\n        <hr />\r\n      </li>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport Alert from \"flarum/common/components/Alert\";\r\n\r\nexport default class CriterionStatus extends Component {\r\n  view() {\r\n    const criterion = this.attrs.criterion;\r\n\r\n    if (!criterion) return;\r\n    const messages = [];\r\n\r\n    if (criterion.isValid()) {\r\n      messages.push(\r\n        <Alert type=\"success\" dismissible={false}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.valid\"\r\n          )}\r\n        </Alert>\r\n      );\r\n    } else {\r\n      messages.push(\r\n        <Alert type=\"error\" dismissible={false}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.invalid\"\r\n          )}\r\n        </Alert>\r\n      );\r\n    }\r\n\r\n    const actionValidation = criterion.invalidActionSettings();\r\n    if (actionValidation && Object.keys(actionValidation).length) {\r\n      messages.push(\r\n        <Alert type=\"error\" dismissible={false}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.action_validation_errors\"\r\n          )}\r\n          <div>\r\n            <ol>\r\n              {Object.keys(actionValidation).map((key) => (\r\n                <li>\r\n                  <strong>{key}:</strong> {actionValidation[key].join(\"\")}\r\n                </li>\r\n              ))}\r\n            </ol>\r\n          </div>\r\n        </Alert>\r\n      );\r\n    }\r\n\r\n    const requirementValidation = criterion.invalidRequirementSettings();\r\n    if (requirementValidation && Object.keys(requirementValidation).length) {\r\n      messages.push(\r\n        <Alert type=\"error\" dismissible={false}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.requirement_validation_errors\"\r\n          )}\r\n          <div>\r\n            <ol>\r\n              {Object.keys(requirementValidation).map((key) => (\r\n                <li>\r\n                  <strong>{key}:</strong> {requirementValidation[key].join(\"\")}\r\n                </li>\r\n              ))}\r\n            </ol>\r\n          </div>\r\n        </Alert>\r\n      );\r\n    }\r\n\r\n    if (\r\n      criterion.metrics().length === 0 &&\r\n      criterion.requirements().length === 0\r\n    ) {\r\n      messages.push(\r\n        <Alert type=\"danger\" dismissible={false}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.no_metrics_or_reqs\"\r\n          )}\r\n        </Alert>\r\n      );\r\n    }\r\n\r\n    if (criterion.actions().length === 0) {\r\n      messages.push(\r\n        <Alert type=\"danger\" dismissible={false}>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.no_actions\"\r\n          )}\r\n        </Alert>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"StatusCheck Form-group\">\r\n        <label>\r\n          {app.translator.trans(\r\n            \"nodeloc-auto-moderator.admin.criterion_status.heading\"\r\n          )}\r\n        </label>\r\n        {messages}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport Button from \"flarum/components/Button\";\r\nimport Dropdown from \"flarum/components/Dropdown\";\r\nimport icon from \"flarum/helpers/icon\";\r\nimport Group from \"flarum/models/Group\";\r\n\r\nexport default class GroupSelector extends Component {\r\n  view() {\r\n    const group = app.store.getById(\"groups\", this.attrs.value);\r\n    const label = group\r\n      ? [icon(group.icon()), \"\\t\", group.namePlural()]\r\n      : app.translator.trans(\r\n          \"nodeloc-auto-moderator.admin.group_selector.placeholder\"\r\n        );\r\n    return (\r\n      <div className=\"Form-group\">\r\n        <label>{this.attrs.label}</label>\r\n\r\n        {this.attrs.disabled ? (\r\n          <div className=\"Button Button--danger\">{label}</div>\r\n        ) : (\r\n          <Dropdown\r\n            label={label}\r\n            disabled={this.attrs.disabled}\r\n            buttonClassName=\"Button Button--danger\"\r\n          >\r\n            {app.store\r\n              .all(\"groups\")\r\n              .filter(\r\n                (g) => ![Group.MEMBER_ID, Group.GUEST_ID].includes(g.id())\r\n              )\r\n              .map((g) =>\r\n                Button.component(\r\n                  {\r\n                    active: group && group.id() === g.id(),\r\n                    disabled: group && group.id() === g.id(),\r\n                    icon: g.icon(),\r\n                    onclick: () => {\r\n                      this.attrs.onchange(g.id());\r\n                    },\r\n                  },\r\n                  g.namePlural()\r\n                )\r\n              )}\r\n          </Dropdown>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/Component\";\r\nimport GroupSelector from \"./GroupSelector\";\r\n\r\nexport default class GroupActionDriverSettings extends Component {\r\n  view() {\r\n    const settings = this.attrs.settings;\r\n\r\n    return (\r\n      <GroupSelector\r\n        value={settings().group_id}\r\n        onchange={(val) => settings({ group_id: val })}\r\n      ></GroupSelector>\r\n    );\r\n  }\r\n}\r\n","import Component from \"flarum/common/Component\";\r\nimport Switch from \"flarum/common/components/Switch\";\r\n\r\nexport default class SuspendSelector extends Component {\r\n  view() {\r\n    const settings = this.attrs.settings;\r\n\r\n    return (\r\n      <div className=\"Form-group\">\r\n        <div className=\"Form-group\">\r\n          <Switch\r\n            state={settings().indefinitely}\r\n            onchange={(val) => settings({ ...settings(), indefinitely: val })}\r\n          >\r\n            {app.translator.trans(\r\n              \"nodeloc-auto-moderator.admin.suspend_selector.indefinitely\"\r\n            )}\r\n          </Switch>\r\n        </div>\r\n        {!settings().indefinitely && (\r\n          <div className=\"Form-group\">\r\n            <input\r\n              className=\"FormControl\"\r\n              type=\"number\"\r\n              min=\"0\"\r\n              value={settings().days}\r\n              onchange={(e) =>\r\n                settings({ ...settings(), days: e.target.value })\r\n              }\r\n              placeholder={app.translator.trans(\r\n                \"nodeloc-auto-moderator.admin.suspend_selector.days\"\r\n              )}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import augmentEditUserModal from \"../common/augmentEditUserModal\";\r\nimport registerModels from \"../common/registerModels\";\r\nimport AutoModeratorPage from \"./components/AutoModeratorPage\";\r\nimport CriterionPage from \"./components/CriterionPage\";\r\nimport GroupIdSelector from \"./components/GroupIdSelector\";\r\nimport SuspendSelector from \"./components/SuspendSelector\";\r\n\r\napp.initializers.add(\"nodeloc/flarum-auto-moderator\", () => {\r\n  app.routes.criterion = {\r\n    path: \"/nodeloc-auto-moderator/criterion/:id\",\r\n    component: CriterionPage,\r\n  };\r\n\r\n  app.autoModeratorForms = {\r\n    action: {\r\n      add_to_group: GroupIdSelector,\r\n      remove_from_group: GroupIdSelector,\r\n      suspend: SuspendSelector,\r\n    },\r\n    requirement: {\r\n      in_group: GroupIdSelector,\r\n    },\r\n  };\r\n\r\n  app.extensionData\r\n    .for(\"nodeloc-auto-moderator\")\r\n    .registerPage(AutoModeratorPage);\r\n\r\n  app.route.criterion = (criterion) => {\r\n    return app.route(\"criterion\", { id: criterion?.id() || \"new\" });\r\n  };\r\n\r\n  augmentEditUserModal();\r\n  registerModels();\r\n});\r\n"],"sourceRoot":""}